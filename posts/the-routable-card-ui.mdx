---
title: The Linkable and Accessible with Interactive Descendant HTML Structure
slug: the-linkable-and-accessible-with-interactive-descendant-html-structure
tags:
  - a11y
  - html
date: 2022-06-07
---

紀錄網頁開發常見的 routable card ui ，個人認為較符合 a11y 的作法，參考樣式如下

![voicetube-trending-videos-ui](/images/voicetube-trending-videos-ui.png)

- 點擊卡片可以跳轉至該影片頁面
- 點擊卡片上的 tag 可以跳轉至對應主題的影片列表頁
- 點擊卡片上的愛心 icon button 可以收藏影片

## The Anchor Element Content Model

要讓整張卡片為可點擊的連結，且擁有可互動的子元素，你可能寫出類似下方的 html

因為要避免 descendant elements 的 event bubbling, default behavior，連帶觸發 parent element 的 event listener, default behavior，例如點了收藏影片的 button，觸發 parent element action 導致網頁跳轉，所以需要在 interactive descendant 的 event handler 加上

- `e.preventDefault()`
- `e.stopPropagation()`

```jsx
const VideoCard = () => {
  const handleCardClick = () => {
    // do something, e.g. event tracking
  };

  const handleButtonClick = (e) => {
    e.preventDefault();
    e.stopPropagation();
    // do something, e.g. event tracking
  };

  const handleTagClick = (e) => {
    e.preventDefault();
    e.stopPropagation();
    // do something, e.g. event tracking
  };

  return (
    <a
      href="/to-video-page"
      className="video-card"
      onClick={handleCardClick}
    >
      <p>video title</p>

      {/* interactive elements */}
      <button onClick={handleButtonClick}>
        save video
      </button>
      <a
        href="/to-tag1-category"
        onClick={handleTagClick}
      >
        tag 1
      </a>
      <a
        href="/to-tag2-category"
        onClick={handleTagClick}
      >
        tag 2
      </a>
    </a>
  );
};
```

基於 [whatwg - the a element standard](https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element)

>Content model: Phrasing content, but there must be no interactive content descendant and no descendant with the tabindex attribute specified.

個人認為這不是一個好的實作方式。從 accessibility tree 角度來看，anchor element 有許多 interactive descendant，不易於 screen reader 解讀，提供給使用者的操作資訊，也可能混淆使用者

為了改善不符合標準衍生出的 workaround，我們先將 root element 的 tag 從 `a` 換成 `div`，並改在 `div` 的 click handler 控制頁面跳轉，如此一來，便能移除 descendant elements event handler 

- `e.preventDefault()`
- `e.stopPropagation()`

如下方程式碼所示

```jsx
const VideoCard = () => {
  const handleCardClick = () => {
    // do something, e.g. event tracking
    window.location.href = '/to-video-page';
  };

  const handleButtonClick = () => {
    // do something, e.g. event tracking
  };

  const handleTagClick = () => {
    // do something, e.g. event tracking
  };

  return (
    <div
      className="video-card"
      onClick={handleCardClick}
    >
      <p>video name</p>

      {/* interactive elements */}
      <button onClick={handleButtonClick}>
        save video
      </button>
      <a
        href="/to-tag1-category"
        onClick={handleTagClick}
      >
        tag 1
      </a>
      <a
        href="/to-tag2-category"
        onClick={handleTagClick}
      >
        tag 2
      </a>
    </div>
  );
};
```

這次的修改，同時也衍生出了幾個使用上問題

- `div` 預設不支援 keyboard navigation (tabindex)，使用者沒辦法透過 `tab` 鍵訪問到卡片對應的影片連結後，利用 `enter` 選取連結 (需要額外實作)
- 使用者沒辦法透過右鍵叫出 `right-click menu`，選取另開分頁的選項
- 使用者沒辦法 `cmd + 左鍵` 另開分頁

## The More Accessible Solution

要解決上述提到的操作上的問題

這裡的作法是在原本用來標記 video name 的 html tag，加上一個影片連結的 `a` tag，並透過 pseudo element 延伸可點擊範圍，藉此達到支援另開分頁的效果，並提高 interactive descendant 的 `z-index` 層級，避免與影片連結的 `a` tag 相互干擾

因為 `a` tag 預設即支援 `tab` 鍵訪問，因此不需要額外指定 `tabindex`，也解決了基本的 keyboard compatibility 的需求

```jsx
const VideoCard = () => {
  const handleCardClick = () => {
    // do something, e.g. event tracking
  };

  const handleButtonClick = () => {
    // do something, e.g. event tracking
  };

  const handleTagClick = () => {
    // do something, e.g. event tracking
  };

  return (
    <div className="video-card">
      <p>
        <a
          href="/to-video-page"
          className="video-card__link"
          onClick={handleCardClick}
        >
          video name
        </a>
      </p>

      {/* interactive elements */}
      <button
        className="video-card__interacitve-element"
        onClick={handleButtonClick}
      >
        save video
      </button>
      <a
        href="/to-tag1-category"
        className="video-card__interacitve-element"
        onClick={handleTagClick}
      >
        tag 1
      </a>
      <a
        href="/to-tag2-category"
        className="video-card__interacitve-element"
        onClick={handleTagClick}
      >
        tag 2
      </a>
    </div>
  );
};
```

```scss
.video-card {
  position: relative;
  .video-card__link::after {
    content: "";
    position: absolute;
    inset: 0;
  }
  .video-card__interactive-element {
    z-index: 1;
  }
}
```


## References

[stackoverflow - whats-the-difference-between-event-stoppropagation-and-event-preventdefault](https://stackoverflow.com/questions/5963669/whats-the-difference-between-event-stoppropagation-and-event-preventdefault)

[whatwg - the a element standard](https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element)
